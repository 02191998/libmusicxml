#!/bin/sh
#

function kname() {
	echo k_$1 | tr '-' '_'
}

case $2 in
	'constants')
		cat templates/license.txt templates/elements.txt
		for a in $(cat $1 | cut -d'	' -f1 | sort -u )
		do
			echo "	$(kname $a),"
		done
		cat << ! 
	kEndElement
};

}
#endif

!
		;;

	'map')
		cat templates/license.txt templates/factory.txt
		for a in $(cat $1 | cut -d'	' -f1 | sort -u)
		do
			echo "	fMap[\"$a\"] 	= new newElementFunctor<$(kname $a)>;"
		done
		echo
		for a in $(cat $1 | cut -d'	' -f1 | sort -u)
		do
			echo "	fType2Name[$(kname $a)] 	= \"$a\";"
		done
		echo '}'
		echo '}'
		;;

	'typemap')
		cat templates/license.txt templates/typeMap.txt
		for a in $(cat $1 | cut -d'	' -f1 | sort -u)
		do
			echo "   fMap[$(kname $a)] 	= \"$a\";"
		done
		echo "}"
		echo "}"
		;;


	'types')
		cat templates/license.txt templates/typedefs.txt
		for a in $(cat $1 | cut -d'	' -f1 | sort -u)
		do
			echo "typedef SMARTP<musicxml<$(kname $a)> >		S_$(echo $a | tr '-' '_');"
		done
		echo '}'
		echo '#endif'
		;;

	*)
		echo "usage: elements eltsfile [constants | map | types]"
		exit 1
		;;
esac	

exit 0

